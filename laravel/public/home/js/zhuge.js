!function(){var a=Array.prototype,b=Object.prototype,c=a.slice,d=b.toString,e=b.hasOwnProperty,f=window.console,g=window.navigator,h=window.document,i=g.userAgent,j={},k="2.0",l="https://",m=(window.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest,!1),n={api_host:"http://xiaozhuge.we.com/web_event/web.gif?method=web_event_srv.upload",api_host_bac:"http://xiaozhuge.we.com/web_event/web.gif?method=web_event_srv.upload",debug:!1,ping:!1,ping_interval:12e3,idle_timeout:3e5,idle_threshold:1e4,track_link_timeout:300,cookie_expire_days:365,cookie_cross_subdomain:!0,cookie_secure:!1,info_upload_interval_days:7,session_interval_mins:30,app_channel:"js",app_version:"1.0",superProperty:"{}",platform:"{}"};!function(){var b=a.forEach,f=Array.isArray,g={};j.each=function(a,c,d){if(null!=a)if(b&&a.forEach===b)a.forEach(c,d);else if(a.length===+a.length){for(var f=0,h=a.length;h>f;f++)if(f in a&&c.call(d,a[f],f,a)===g)return}else for(var i in a)if(e.call(a,i)&&c.call(d,a[i],i,a)===g)return},j.extend=function(a){return j.each(c.call(arguments,1),function(b){for(var c in b)void 0!==b[c]&&(a[c]=b[c])}),a},j.isUndefined=function(a){return void 0===a},j.isString=function(a){return"[object String]"==d.call(a)},j.isArray=f||function(a){return"[object Array]"===d.call(a)},j.isFunction=function(a){return"[object Function]"===d.call(a)},j.isObject=function(a){return"[object Object]"===d.call(a)},j.includes=function(a,b){return-1!==a.indexOf(b)},j.encode=function(a){var b={};for(var c in a)b["_"+c]=a[c];return b}}(),j.truncate=function(a,b){var c;return"string"==typeof a?c=a.slice(0,b):j.isArray(a)?(c=[],j.each(a,function(a){c.push(j.truncate(a,b))})):j.isObject(a)?(c={},j.each(a,function(a,d){c[d]=j.truncate(a,b)})):c=a,c},j.strip_empty_properties=function(a){var b={};return j.each(a,function(a,c){j.isString(a)&&a.length>0&&(b[c]=a)}),b},j.JSONEncode=function(){return function(a){var b=a,c=function(a){var b=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,c={"\b":"\\b"," ":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};return b.lastIndex=0,b.test(a)?'"'+a.replace(b,function(a){var b=c[a];return"string"==typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'},f=function(a,b){var g="",h="    ",i=0,j="",k="",l=0,m=g,n=[],o=b[a];switch(o&&"object"==typeof o&&"function"==typeof o.toJSON&&(o=o.toJSON(a)),typeof o){case"string":return c(o);case"number":return isFinite(o)?String(o):"null";case"boolean":case"null":return String(o);case"object":if(!o)return"null";if(g+=h,n=[],"[object Array]"===d.apply(o)){for(l=o.length,i=0;l>i;i+=1)n[i]=f(i,o)||"null";return k=0===n.length?"[]":g?"[\n"+g+n.join(",\n"+g)+"\n"+m+"]":"["+n.join(",")+"]",g=m,k}for(j in o)e.call(o,j)&&(k=f(j,o),k&&n.push(c(j)+(g?": ":":")+k));return k=0===n.length?"{}":g?"{"+n.join(",")+m+"}":"{"+n.join(",")+"}",g=m,k}};return f("",{"":b})}}(),j.JSONDecode=function(){var a,b,c,d,e={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"    "},f=function(b){throw{name:"SyntaxError",message:b,at:a,text:c}},g=function(d){return d&&d!==b&&f("Expected '"+d+"' instead of '"+b+"'"),b=c.charAt(a),a+=1,b},h=function(){var a,c="";for("-"===b&&(c="-",g("-"));b>="0"&&"9">=b;)c+=b,g();if("."===b)for(c+=".";g()&&b>="0"&&"9">=b;)c+=b;if("e"===b||"E"===b)for(c+=b,g(),("-"===b||"+"===b)&&(c+=b,g());b>="0"&&"9">=b;)c+=b,g();return a=+c,isFinite(a)?a:void f("Bad number")},i=function(){var a,c,d,h="";if('"'===b)for(;g();){if('"'===b)return g(),h;if("\\"===b)if(g(),"u"===b){for(d=0,c=0;4>c&&(a=parseInt(g(),16),isFinite(a));c+=1)d=16*d+a;h+=String.fromCharCode(d)}else{if("string"!=typeof e[b])break;h+=e[b]}else h+=b}f("Bad string")},j=function(){for(;b&&" ">=b;)g()},k=function(){switch(b){case"t":return g("t"),g("r"),g("u"),g("e"),!0;case"f":return g("f"),g("a"),g("l"),g("s"),g("e"),!1;case"n":return g("n"),g("u"),g("l"),g("l"),null}f("Unexpected '"+b+"'")},l=function(){var a=[];if("["===b){if(g("["),j(),"]"===b)return g("]"),a;for(;b;){if(a.push(d()),j(),"]"===b)return g("]"),a;g(","),j()}}f("Bad array")},m=function(){var a,c={};if("{"===b){if(g("{"),j(),"}"===b)return g("}"),c;for(;b;){if(a=i(),j(),g(":"),Object.hasOwnProperty.call(c,a)&&f('Duplicate key "'+a+'"'),c[a]=d(),j(),"}"===b)return g("}"),c;g(","),j()}}f("Bad object")};return d=function(){switch(j(),b){case"{":return m();case"[":return l();case'"':return i();case"-":return h();default:return b>="0"&&"9">=b?h():k()}},function(e){var g;return c=e,a=0,b=" ",g=d(),j(),b&&f("Syntax error"),g}}(),j.HTTPBuildQuery=function(a,b){var c,d,e=[];return"undefined"==typeof b&&(b="&"),j.each(a,function(a,b){c=encodeURIComponent(a.toString()),d=encodeURIComponent(b),e[e.length]=d+"="+c}),e.join(b)},j.getQueryParam=function(a,b){b=b.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var c="[\\?&#]"+b+"=([^&#]*)",d=new RegExp(c),e=d.exec(a);return null===e||e&&"string"!=typeof e[1]&&e[1].length?"":decodeURIComponent(e[1]).replace(/\+/g," ")},j.getDomain=function(a){var b=a.match(/\/\/\S*?\//);return b&&b.length?b[0].replace(/\//g,""):""},j.register_event=function(){function a(a,c,d){var e=function(e){if(e=e||b(window.event),!e)return void 0;var f,g,h=!0;return j.isFunction(d)&&(f=d(e)),g=c.call(a,e),(!1===f||!1===g)&&(h=!1),h};return e}function b(a){return a&&(a.preventDefault=b.preventDefault,a.stopPropagation=b.stopPropagation),a}var c=function(b,c,d,e){if(!b)return void o.error("No valid element provided to register_event");if(b.addEventListener&&!e)b.addEventListener(c,d,!1);else{var f="on"+c,g=b[f];b[f]=a(b,d,g)}};return b.preventDefault=function(){this.returnValue=!1},b.stopPropagation=function(){this.cancelBubble=!0},c}(),j.cookie={get:function(a){for(var b=a+"=",c=h.cookie.split(";"),d=0;d<c.length;d++){for(var e=c[d];" "==e.charAt(0);)e=e.substring(1,e.length);if(0==e.indexOf(b))return decodeURIComponent(e.substring(b.length,e.length))}return null},parse:function(a){var b;try{b=j.JSONDecode(j.cookie.get(a))||{}}catch(c){}return b},set:function(a,b,c,d,e){var f="",g="",i="";if(d){var j=h.location.hostname.match(/[a-z0-9][a-z0-9\-]+\.[a-z\.]{2,6}$/i),k=j?j[0]:"";f=k?"; domain=."+k:""}if(c){var l=new Date;l.setTime(l.getTime()+24*c*60*60*1e3),g="; expires="+l.toGMTString()}e&&(i="; secure"),h.cookie=a+"="+encodeURIComponent(b)+g+"; path=/"+f+i},remove:function(a,b){j.cookie.set(a,"",-1,b)}},j.UUID=function(){var a=function(){for(var a=1*new Date,b=0;a==1*new Date;)b++;return a.toString(16)+b.toString(16)},b=function(){return Math.random().toString(16).replace(".","")},c=function(a){function b(a,b){var c,d=0;for(c=0;c<b.length;c++)d|=f[c]<<8*c;return a^d}var c,d,e=i,f=[],g=0;for(c=0;c<e.length;c++)d=e.charCodeAt(c),f.unshift(255&d),f.length>=4&&(g=b(g,f),f=[]);return f.length>0&&(g=b(g,f)),g.toString(16)};return function(){var d=(screen.height*screen.width).toString(16);return a()+"-"+b()+"-"+c()+"-"+d+"-"+a()}}(),j.info={campaignParams:function(){var a="utm_source utm_medium utm_campaign utm_content utm_term".split(" "),b="",c={};return j.each(a,function(a){b=j.getQueryParam(h.URL,a),b.length&&(c["$"+a]=b)}),c},searchEngine:function(a){return 0===a.search("https?://(.*)google.([^/?]*)")?"google":0===a.search("https?://(.*)baidu.com")?"baidu":0===a.search("https?://(.*)sogou.com")?"sogou":0===a.search("https?://(.*)haosou.com")?"haosou":null},searchKeyword:function(a){var b=j.info.searchEngine(a);return"google"==b?j.getQueryParam(a,"q"):"baidu"==b?j.getQueryParam(a,"wd"):"sogou"==b?j.getQueryParam(a,"query"):"haosou"==b?j.getQueryParam(a,"q"):null},referringDomain:function(a){var b=a.split("/");return b.length>=3?b[2]:""},browser:function(a,b,c){var b=b||"";return c?j.includes(a,"Mini")?"Opera Mini":"Opera":/(BlackBerry|PlayBook|BB10)/i.test(a)?"BlackBerry":j.includes(a,"FBIOS")?"Facebook Mobile":j.includes(a,"Chrome")?"Chrome":j.includes(a,"CriOS")?"Chrome iOS":j.includes(b,"Apple")?j.includes(a,"Mobile")?"Mobile Safari":"Safari":j.includes(a,"Android")?"Android Mobile":j.includes(a,"Konqueror")?"Konqueror":j.includes(a,"Firefox")?"Firefox":j.includes(a,"MSIE")||j.includes(a,"Trident/")?"Internet Explorer":j.includes(a,"Gecko")?"Mozilla":""},os:function(){var a=i;return/Windows/i.test(a)?/Phone/.test(a)?"Windows Mobile":"Windows":/(iPhone|iPad|iPod)/.test(a)?"iOS":/Android/.test(a)?"Android":/(BlackBerry|PlayBook|BB10)/i.test(a)?"BlackBerry":/Mac/i.test(a)?"Mac OS X":/Linux/.test(a)?"Linux":""},device:function(a){return/iPad/.test(a)?"iPad":/iPod/.test(a)?"iPod Touch":/iPhone/.test(a)?"iPhone":/(BlackBerry|PlayBook|BB10)/i.test(a)?"BlackBerry":/Windows Phone/i.test(a)?"Windows Phone":/Android/.test(a)?"Android":""},resolution:function(){return screen.width+"*"+screen.height}};var o={log:function(){if(m&&!j.isUndefined(f)&&f)try{f.log.apply(f,arguments)}catch(a){j.each(arguments,function(a){f.log(a)})}},error:function(){try{if(m&&!j.isUndefined(f)&&f){var a=["Zhuge error:"].concat(j.toArray(arguments));try{f.error.apply(f,a)}catch(b){j.each(a,function(a){f.error(a)})}}}catch(c){}}},p=function(a){this.name="_zg",this.props={},this.config=j.extend({},a),this.load()};p.prototype.load=function(){var a=j.cookie.parse(this.name);a&&(this.props=j.extend({},a))},p.prototype.save=function(){j.cookie.set(this.name,j.JSONEncode(this.props),this.config.cookie_expire_days,this.config.cookie_cross_subdomain,this.config.cookie_secure)},p.prototype.register_once=function(a,b){return j.isObject(a)?("undefined"==typeof b&&(b="None"),j.each(a,function(a,c){this.props[c]&&this.props[c]!==b||(this.props[c]=a)},this),this.save(),!0):!1},p.prototype.register=function(a){return j.isObject(a)?(j.extend(this.props,a),this.save(),!0):!1};var q=function(){this.config={},j.extend(this.config,n),this.idle=0,this.last_activity=new Date};q.prototype._init=function(a,b){if(this._key=a,this._jsc=function(){},j.isObject(b)){j.extend(this.config,b),m=m||this.config.debug;for(var c in this.config)j.isObject(this.config[c])&&(this.config[c]=j.JSONEncode(this.config[c]))}this.cookie=new p(this.config),this.cookie.register_once({uuid:j.UUID(),sid:0,updated:0,info:0,superProperty:this.config.superProperty,platform:this.config.platform},""),this._session(),this._info(),this._startPing()},q.prototype._session=function(){var a=this.cookie.props.updated,b=this.cookie.props.sid,c=1*new Date,d=new Date;if(0==b||c>a+60*this.config.session_interval_mins*1e3){if(b>0&&a>0){var e={dt:"se",pr:{}};e.pr.$ct=d.getTime(),e.pr.$tz=6e4*-d.getTimezoneOffset(),e.pr.$dru=a-b,e.pr.$sid=b,e.pr.$cuid=this.cookie.props.cuid,this._batchTrack(e)}b=c;var f={dt:"ss",pr:{}},g=j.info.campaignParams();f.pr=j.extend(f.pr,g),this.cookie.register({utm:j.JSONEncode(g)},""),f.pr.$ct=d.getTime(),f.pr.$sid=b,f.pr.$cuid=this.cookie.props.cuid,f.pr.$cn=this.config.app_channel,f.pr.$vn=this.config.app_version,f.pr.$tz=6e4*-d.getTimezoneOffset(),f.pr.$url=location.href,f.pr.$ref=h.referrer;var i=j.getDomain(h.referrer);f.pr.$referrer_domain=i,this.cookie.register({referrerDomain:i},""),this._batchTrack(f),this.cookie.register({sid:b},"")}this.cookie.register({updated:c},"")},q.prototype._info=function(){var a=this.cookie.props.info,b=1*new Date;if(b>a+24*this.config.info_upload_interval_days*60*60*1e3){var c={dt:"pl",pr:{$rs:j.info.resolution()}},d=new Date;c.pr.$tz=6e4*-d.getTimezoneOffset(),c.pr.$ct=d.getTime(),c.pr.$cuid=this.cookie.props.cuid,c.pr=j.extend(c.pr,j.encode(j.JSONDecode(this.cookie.props.platform))),this._batchTrack(c),this.cookie.register({info:b},"")}},q.prototype.debug=function(a){m=a},q.prototype.identify=function(a,b,c){var d=j.isObject(b)?b:{},e=j.isObject(b)?c:b;this.cookie.register({cuid:a},""),this._session();var f={dt:"usr",pr:{}},g=new Date;f.pr.$ct=g.getTime(),f.pr.$tz=6e4*-g.getTimezoneOffset(),f.pr.$cuid=a,f.pr.$sid=this.cookie.props.sid,f.pr.$url=location.href,f.pr.$ref=h.referrer,f.pr=j.extend(f.pr,j.encode(d)),this._batchTrack(f,e)},q.prototype.setUserProperties=function(a,b){this.identify(this.cookie.props.cuid,a,b)},q.prototype.page=function(a,b){this._session();var c=h.location.href,d={};d.et="pg",d.pid=c,d.pn="undefined"==typeof a?c:a,d.tl=h.title,d.ref=h.referrer,d.sid=this.cookie.props.sid,this._batchTrack(d,b)},q.prototype.track=function(a,b,c){var d=j.isObject(b)?b:{},e=j.isObject(b)?c:b;this._session();var f={dt:"evt",pr:{}},g=new Date,i=this.cookie.props.utm?j.JSONDecode(this.cookie.props.utm):{};f.pr.$ct=g.getTime(),f.pr.$tz=6e4*-g.getTimezoneOffset(),f.pr.$cuid=this.cookie.props.cuid,f.pr.$sid=this.cookie.props.sid,f.pr.$url=h.URL,f.pr.$ref=h.referrer,f.pr.$eid=a,f.pr.$referrerDomain=this.cookie.props.referrerDomain;for(var k in i)f.pr[k]=i[k];f.pr=j.extend(f.pr,j.encode(d)),f.pr=j.extend(f.pr,j.encode(j.JSONDecode(this.cookie.props.superProperty))),this._batchTrack(f,e)},q.prototype._moved=function(a){this.last_activity=new Date,this.idle=0},q.prototype._startPing=function(){var a=this;j.register_event(window,"mousemove",function(){a._moved.apply(a,arguments)}),"undefined"==typeof this.pingInterval&&(this.pingInterval=window.setInterval(function(){a._ping()},this.config.ping_interval))},q.prototype._stopPing=function(){"undefined"!=typeof this.pingInterval&&(window.clearInterval(this.pingInterval),delete this.pingInterval)},q.prototype._ping=function(){if(this.config.ping&&this.idle<this.config.idle_timeout){var a={};a.type="ping",a.sdk="web",a.sdkv=k,a.ak=this._key,a.did=this.cookie.props.uuid,a.cuid=this.cookie.props.cuid,this._sendTrackRequest(a)}else this._stopPing();var b=new Date;return b-this.last_activity>this.config.idle_threshold&&(this.idle=b-this.last_activity),this},q.prototype.getDid=function(){return this.cookie.props.uuid},q.prototype.getSid=function(){return this.cookie.props.sid},q.prototype.setSuperProperty=function(a){j.isObject(a)&&this.cookie.register({superProperty:j.JSONEncode(a)})},q.prototype.setPlatform=function(a){j.isObject(a)&&(this.cookie.register({platform:j.JSONEncode(a),info:0}),this._info())},q.prototype._batchTrack=function(a,b){var c={},d=new Date;c.sln="itn",c.pl="js",c.sdk="zg-js",c.sdkv=k,c.owner="zg",c.ut=[d.getFullYear(),d.getMonth()+1,d.getDate()].join("-")+" "+d.toTimeString().match(/\d{2}:\d{2}:\d{2}/)[0],c.tz=6e4*-d.getTimezoneOffset(),c.debug=this.config.debug?1:0,c.ak=this._key,c.usr={did:this.cookie.props.uuid};var e=[];e.push(a),c.data=e,this._sendTrackRequest(c,this._prepareCallback(b,c))},q.prototype._prepareCallback=function(a,b){if(!j.isFunction(a))return null;var c=function(c){a(c,b)};return c},q.prototype._sendTrackRequest=function(a,b){var c=j.truncate(a,255),d=j.JSONEncode(c);data={event:d,_:(new Date).getTime().toString()};var e={bac:this.config.api_host_bac+"&"+j.HTTPBuildQuery(data),normal:this.config.api_host+"&"+j.HTTPBuildQuery(data)};this._sendRequest(e,b)},q.prototype._sendRequest=function(a,b){var c=((new Date).getTime(),new Image);c.src=a.normal,c.onload=function(){b&&b()},c.onerror=function(c){var d=new Image;d.src=a.bac,d.onload=function(){b&&b()},d.onerror=function(){b&&b()}}},q.prototype.push=function(a){var b=a.shift();this[b]&&this[b].apply(this,a)},q.prototype.getKey=function(){return this._key};for(var r=window.zhuge||[],s=new q;r&&r.length>0;){var t=r.shift(),u=t.shift();s[u]&&s[u].apply(s,t)}window.zhuge=s}();